# üõ†Ô∏è Monitoring Stack Configs Backup
**–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–π Grafana, Mimir, Loki –∏ Alertmanager**

---

## üîç –ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
–≠—Ç–æ—Ç —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ê–∫—Ç—É–∞–ª—å–Ω—ã–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Å–µ—Ä–≤–∏—Å–æ–≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:
  - `mimir/config.yaml`  
  - `loki/config.yaml`  
  - `alertmanager/config.yaml`  
- Docker Compose —Ñ–∞–π–ª—ã (`compose/production/`)  
- –°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –±—ç–∫–∞–ø–∞ [`sync_and_backup.sh`](../sync_and_backup.sh)

---

## ‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
1. **–ò—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö**:  
   –ö–æ–Ω—Ñ–∏–≥–∏ –±–µ—Ä—É—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø–æ –ø—É—Ç—è–º:
   ```
   /opt/monitoring-configs/{mimir,loki,alertmanager}/config.yaml
   /var/lib/docker/volumes/portainer_data/_data/compose/66/docker-compose.yml
   ```

2. **–°–∫—Ä–∏–ø—Ç –±—ç–∫–∞–ø–∞**:
   - –ö–æ–ø–∏—Ä—É–µ—Ç —Ñ–∞–π–ª—ã ‚Üí –∫–æ–º–º–∏—Ç–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Üí –ø—É—à–∏—Ç –≤ `main`  
   - **–ù–µ —É–¥–∞–ª—è–µ—Ç —Ñ–∞–π–ª—ã**, —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–ª—å–∫–æ –≤ GitHub (–±–µ–∑ `git add --all`)  
   - –õ–æ–≥–∏—Ä—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏—è –≤ `/var/log/monitoring_backup.log`

3. **–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ**:  
   –ê–≤—Ç–æ–∑–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Cron –∫–∞–∂–¥—ã–π –¥–µ–Ω—å –≤ **02:30**:
   ```bash
   30 2 * * * /opt/monitoring-configs/sync_and_backup.sh
   ```

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
### –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥–∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
```bash
cd /opt/monitoring-configs/config-grafana-mimir-loki-alertmanager
sudo cp -r mimir/config.yaml /opt/monitoring-configs/mimir/
sudo cp -r loki/config.yaml /opt/monitoring-configs/loki/
```

### –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤—Ä—É—á–Ω—É—é:
```bash
sudo /opt/monitoring-configs/sync_and_backup.sh
```

---

## üîß Troubleshooting
| –ü—Ä–æ–±–ª–µ–º–∞ | –†–µ—à–µ–Ω–∏–µ |
|----------|---------|
| `git push` rejected | –í—ã–ø–æ–ª–Ω–∏—Ç–µ `git pull --rebase origin main` |
| –ù–µ—Ç –ø—Ä–∞–≤ –Ω–∞ –∑–∞–ø–∏—Å—å | `sudo chmod 644 /var/log/monitoring_backup.log` |
| –°–∫—Ä–∏–ø—Ç –ø–∞–¥–∞–µ—Ç —Å –æ—à–∏–±–∫–æ–π | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `tail -f /var/log/monitoring_backup_errors.log` |

---

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è
MIT ¬© [–í–∞—à–µ –∏–º—è/–∫–æ–º–∞–Ω–¥–∞]  
**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: 2025-03-28
```

---

### –ö–ª—é—á–µ–≤—ã–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:
1. **–ú–∏–Ω–∏–º—É–º —Ç–µ–∫—Å—Ç–∞** ‚Äî —Ç–æ–ª—å–∫–æ —Ñ–∞–∫—Ç—ã –∏ –∫–æ–º–∞–Ω–¥—ã.
2. **–ì–æ—Ç–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è** –¥–ª—è —á–∞—Å—Ç—ã—Ö –ø—Ä–æ–±–ª–µ–º –≤ —Ç–∞–±–ª–∏—Ü–µ.
3. **–õ–æ–≥–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** ‚Äî –æ—Ç –æ–±—â–µ–≥–æ –∫ —á–∞—Å—Ç–Ω–æ–º—É.
4. **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è** ‚Äî –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã –º–æ–∂–Ω–æ —Å—Ä–∞–∑—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å.

–§–∞–π–ª –º–æ–∂–Ω–æ –¥–æ–ø–æ–ª–Ω—è—Ç—å –¥–µ—Ç–∞–ª—è–º–∏ –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ–∫—Ü–∏–µ–π "–ö–æ–Ω—Ç–∞–∫—Ç—ã").
